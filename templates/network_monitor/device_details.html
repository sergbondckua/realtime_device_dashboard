<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–î–µ—Ç–∞–ª—ñ –ø—Ä–∏—Å—Ç—Ä–æ—é - {{ device_ip }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='network_monitor/css/style.css') }}">
</head>
<body>
<div class="container">
  <div class="header">
    <h1>üì° –î–µ—Ç–∞–ª—ñ –ø—Ä–∏—Å—Ç—Ä–æ—é: {{ device_ip }}</h1>
    <div class="status-bar">
      <a href="/" class="filter-btn">‚Üê –î–æ —Å–ø–∏—Å–∫—É –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤</a>
      <div class="status-item">
        <div class="status-indicator status-online"></div>
        <span>–ê–∫—Ç–∏–≤–Ω–∏—Ö –ø–æ—Ä—Ç—ñ–≤: {{ active_ports_count }}/{{ total_ports_count }}</span>
      </div>
    </div>
  </div>

  <div class="system-info">
    <h2>–°–∏—Å—Ç–µ–º–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</h2>
    <div class="info-grid">
      <div class="info-item">
        <div class="info-label">–ù–∞–∑–≤–∞ —Å–∏—Å—Ç–µ–º–∏</div>
        <div class="info-value">{{ system_info.system_name }}</div>
      </div>
      <div class="info-item">
        <div class="info-label">–ú–æ–¥–µ–ª—å</div>
        <div class="info-value">{{ system_info.model }}</div>
      </div>
      <div class="info-item">
        <div class="info-label">MAC –∞–¥—Ä–µ—Å–∞</div>
        <div class="info-value">{{ system_info.mac_address }}</div>
      </div>
      <div class="info-item">
        <div class="info-label">–ß–∞—Å —Ä–æ–±–æ—Ç–∏</div>
        <div class="info-value">{{ system_info.uptime }}</div>
      </div>
    </div>
  </div>

  <div class="table_port">
    <div class="filters">
      <button class="filter-btn active" data-filter="all">–£—Å—ñ –ø–æ—Ä—Ç–∏</button>
      <button class="filter-btn" data-filter="active">–ê–∫—Ç–∏–≤–Ω—ñ</button>
      <button class="filter-btn" data-filter="inactive">–ù–µ–∞–∫—Ç–∏–≤–Ω—ñ</button>
    </div>

    <div class="legend desktop-only">
      <div>–ü–æ—Ä—Ç</div>
      <div>–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</div>
      <div>–°—Ç–∞—Ç—É—Å</div>
      <div>–¢—Ä–∞—Ñ—ñ–∫</div>
      <div></div>
      <div>–ì—Ä–∞—Ñ—ñ–∫</div>
    </div>

    {% for iface_id, iface in interfaces.items() %}
      <div class="item" data-status="{% if iface.oper_status == 1 %}active{% else %}inactive{% endif %}">
        <div class="port_number">
          {{ iface_id }}
          <span class="port_edit desktop-only">‚úé</span>
        </div>
        <div class="port_connection">
          <div class="client-name">{{ iface.alias if iface.alias else "" }}</div>
          <div class="port-descr">{{ iface.name }}</div>
          {% if iface.speed > 0 %}
            <div class="device-info">
              <span class="label_backblack">{{ iface.speed//1000000 }}M</span>
              {{ iface.speed|format_speed }}
            </div>
          {% endif %}
        </div>
        <div>
          <div class="port_admin_status {% if iface.admin_status == 1 %}port_green{% else %}port_red{% endif %}">
            {{ "–ê–∫—Ç–∏–≤–Ω–æ" if iface.admin_status == 1 else "–í–∏–º–∫–Ω–µ–Ω–æ" }}
          </div>
          <div class="port_link_status {% if iface.oper_status == 1 %}port_green{% else %}port_red{% endif %}">
            {{ "up" if iface.oper_status == 1 else "down" }}
          </div>
        </div>
        <div class="port_traf">
          <div>
            <span class="traf-icon us-traf-in">‚¨áÔ∏è</span>
            <span class="bold_text">{{ iface.in_octets|format_bytes }}</span>
            <span class="div_small">({{ iface.in_pkts|format_packets }})</span>
          </div>
          <div>
            <span class="traf-icon us-traf-out">‚¨ÜÔ∏è</span>
            <span class="bold_text">{{ iface.out_octets|format_bytes }}</span>
            <span class="div_small">({{ iface.out_pkts|format_packets }})</span>
          </div>
          {% if iface.in_errors > 0 or iface.out_errors > 0 %}
            <div class="red_text">
              –ü–æ–º–∏–ª–æ–∫: {{ iface.in_errors + iface.out_errors }}
            </div>
          {% endif %}
        </div>
        <div class="port_color {% if iface.oper_status == 1 %}active{% endif %}"></div>
        <div class="port_traf">
          <div class="traf-speed">
            <span>‚ñº {{ (iface.in_octets//1024)//60 }} Kb/—Å</span> |
            <span>‚ñ≤ {{ (iface.out_octets//1024)//60 }} Kb/—Å</span>
          </div>
{#          <div class="add-connection desktop-only">+ –î–æ–¥–∞—Ç–∏ –∑'—î–¥–Ω–∞–Ω–Ω—è</div>#}
        </div>
      </div>
    {% endfor %}
  </div>

  <div class="last-update">
    –û–Ω–æ–≤–ª–µ–Ω–æ: {{ last_update }}
  </div>
</div>

<script>
    // –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ—Ä—Ç—ñ–≤
    document.querySelectorAll('.filter-btn').forEach(button => {
        button.addEventListener('click', function () {
            const filter = this.getAttribute('data-filter');

            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            this.classList.add('active');

            // –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è —Ä—è–¥–∫—ñ–≤
            document.querySelectorAll('.item').forEach(row => {
                if (filter === 'all') {
                    row.style.display = '';
                } else {
                    row.style.display =
                        row.getAttribute('data-status') === filter ? '' : 'none';
                }
            });
        });
    });

    // –ü—É–ª—å—Å–∞—Ü—ñ—è –¥–ª—è –∞–∫—Ç–∏–≤–Ω–∏—Ö –ø–æ—Ä—Ç—ñ–≤
    setInterval(() => {
        document.querySelectorAll('.port_color.active').forEach(el => {
            el.style.animation = 'lightPulse 0.1s infinite alternate';
            setTimeout(() => {
                el.style.animation = '';
            }, 100);
        });
    }, 1000);
</script>
</body>
</html>